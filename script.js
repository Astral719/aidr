document.addEventListener('DOMContentLoaded', () => {
    // --- DATA CONSTANTS ---

    const csvData = `\uFEFF"月份","序号","花名","花语 (四字)","金句"
"一月 (Jan)","1","水仙","纯洁吉祥","凌波仙子生尘袜，水上轻盈步微月。"
"一月 (Jan)","2","梅花","坚强高洁","宝剑锋从磨砺出，梅花香自苦寒来。"
"一月 (Jan)","3","腊梅","慈爱之心","疏影横斜水清浅，暗香浮动月黄昏。"
"一月 (Jan)","4","报春花","希望初见","一朵报春花，唤醒满园春。"
"一月 (Jan)","5","山茶花","理想之爱","唯有山茶殊耐久，独能深月占春风。"
"一月 (Jan)","6","一品红","共祝新生","红红火火，祝福满满。"
"一月 (Jan)","7","君子兰","高贵品格","谦谦君子，温润如玉。"
"一月 (Jan)","8","仙客来","喜迎贵客","有朋远方来，不亦乐乎。"
"一月 (Jan)","9","蟹爪兰","鸿运当头","锦上添花，好运连连。"
"一月 (Jan)","10","长寿花","福寿安康","岁月悠长，健康常伴。"
"一月 (Jan)","11","风信子 (促)","喜悦生命","春风信使，捎来希望。"
"一月 (Jan)","12","郁金香 (促)","博爱体贴","爱如潮水，温柔包容。"
"一月 (Jan)","13","小苍兰","纯洁幸福","清新雅致，幸福满溢。"
"一月 (Jan)","14","雏菊","天真烂漫","暗恋纯美，藏于心间。"
"一月 (Jan)","15","金盏花","惜别感恩","光明指引，前程似锦。"
"一月 (Jan)","16","蜡梅 (盛)","傲骨幽香","不与群芳争，自有暗香来。"
"一月 (Jan)","17","茶梅","清雅高洁","清姿雅韵，谦让之德。"
"一月 (Jan)","18","虎刺梅","坚韧刚直","逆境前行，不屈不挠。"
"一月 (Jan)","19","炮仗花 (南)","富贵吉祥","日子红火，喜庆热闹。"
"一月 (Jan)","20","鹤望兰","自由幸福","展翅高飞，向往自由。"
"一月 (Jan)","21","瓜叶菊 (温)","持久喜悦","快乐相伴，喜悦常在。"
"一月 (Jan)","22","蝴蝶兰","幸福美满","如蝶翩跹，幸福飞来。"
"一月 (Jan)","23","大花蕙兰","丰盛祥和","雍容华贵，吉祥如意。"
"一月 (Jan)","24","朱顶红","渴望被爱","热情洋溢，温暖我心。"
"一月 (Jan)","25","白晶菊","天真无邪","纯白无瑕，如初之心。"
"一月 (Jan)","26","香豌豆 (温)","温馨回忆","甜蜜温柔，美好时光。"
"一月 (Jan)","27","冬珊瑚","喜庆祥瑞","硕果累累，吉祥美满。"
"一月 (Jan)","28","银芽柳","生命光辉","银装素裹，生机勃勃。"
"一月 (Jan)","29","三色堇","思念快乐","游移目光，思念对方。"
"一月 (Jan)","30","兰花 (部分)","淡泊高雅","空谷幽兰，品自高洁。"
"一月 (Jan)","31","结香 (早)","喜结连理","梦中情人，喜悦常驻。"
"二月 (Feb)","1","梅花","傲雪凌霜","已是悬崖百丈冰，犹有花枝俏。"
"二月 (Feb)","2","山茶花","谦逊之德","惟有山茶偏耐久，绿丛又放数枝红。"
"二月 (Feb)","3","报春花 (盛)","希望萌生","春江水暖鸭先知，花信风中报春来。"
"二月 (Feb)","4","风信子","生命活力","点燃生命，充满喜悦。"
"二月 (Feb)","5","郁金香 (早)","爱的表白","浓情蜜意，为你钟情。"
"二月 (Feb)","6","瑞香","祥瑞吉利","花开祥瑞，香飘四溢。"
"二月 (Feb)","7","迎春花","希望活力","金英翠萼带春寒，黄色花中有几般。"
"二月 (Feb)","8","瓜叶菊","快乐活泼","色彩斑斓，喜悦常伴。"
"二月 (Feb)","9","仙客来 (盛)","喜悦好客","宾客盈门，喜气洋洋。"
"二月 (Feb)","10","水仙 (盛)","坚贞爱情","只缘清香成清趣，全因雅洁博雅名。"
"二月 (Feb)","11","君子兰 (盛)","温和有礼","花中君子，德行高尚。"
"二月 (Feb)","12","蟹爪兰 (盛)","运转乾坤","节节攀高，好运相随。"
"二月 (Feb)","13","长寿花 (盛)","大吉大利","长长久久，福寿绵延。"
"二月 (Feb)","14","小苍兰 (盛)","清新舒畅","淡雅芬芳，沁人心脾。"
"二月 (Feb)","15","角堇","思念快乐","小小花朵，大大快乐。"
"二月 (Feb)","16","茶梅 (盛)","高雅端庄","姿态优雅，品性高洁。"
"二月 (Feb)","17","金钟花","隐蔽之美","含蓄内敛，静待欣赏。"
"二月 (Feb)","18","白玉兰 (早)","纯洁高尚","冰清玉洁，品格高雅。"
"二月 (Feb)","19","紫玉兰 (早)","芳香情思","高贵典雅，情意绵绵。"
"二月 (Feb)","20","炮仗花","红火兴旺","喜气洋洋，生活红火。"
"二月 (Feb)","21","结香","家庭美满","情结深厚，幸福相伴。"
"二月 (Feb)","22","金鱼草","活泼有余","金玉满堂，年年有余。"
"二月 (Feb)","23","天竺葵","幸福偶然","偶然相遇，便是幸福。"
"二月 (Feb)","24","兰花 (春兰)","高洁贤德","王者之香，幽雅贤德。"
"二月 (Feb)","25","贴梗海棠","热情平凡","平凡之爱，热情长久。"
"二月 (Feb)","26","郁李","光明美好","娇小玲珑，光明未来。"
"二月 (Feb)","27","马蹄莲","纯洁永恒","博爱圣洁，永结同心。"
"二月 (Feb)","28","香雪兰","纯洁浓情","清香怡人，情意浓浓。"
"二月 (Feb)","29","耧斗菜 (早)","胜利之誓","坚持不懈，必定胜利。"
"二月 (Feb)","30","山茱萸","持续报答","感恩之心，持之以恒。"
"二月 (Feb)","31","雪滴花","生命希望","破雪而出，希望降临。"
"三月 (Mar)","1","迎春花 (盛)","相爱永久","不居渗水畔，直作探春魁。"
"三月 (Mar)","2","玉兰","高洁纯真","霓裳片片晚妆新，束素亭亭玉殿春。"
"三月 (Mar)","3","桃花","爱情俘虏","桃之夭夭，灼灼其华。"
"三月 (Mar)","4","杏花","少女娇羞","一陂春水绕花身，花影妖娆各占春。"
"三月 (Mar)","5","李花","纯洁质朴","李花宜远更宜繁，惟远惟繁始足看。"
"三月 (Mar)","6","樱花 (早)","生命热烈","人生短暂，灿烂绽放。"
"三月 (Mar)","7","油菜花","加油鼓劲","金色希望，遍地生辉。"
"三月 (Mar)","8","郁金香","慈善名誉","美丽优雅，声名远扬。"
"三月 (Mar)","9","风信子 (盛)","忘记悲伤","逝者如斯，迎接未来。"
"三月 (Mar)","10","连翘","预言指导","金色希望，指引方向。"
"三月 (Mar)","11","海棠","温和美丽","只恐夜深花睡去，故烧高烛照红妆。"
"三月 (Mar)","12","紫荆","家庭和睦","骨肉情深，团聚和美。"
"三月 (Mar)","13","二月兰","谦逊质朴","平凡之路，默默奉献。"
"三月 (Mar)","14","蒲公英","停留之爱","随风飘荡，爱不止息。"
"三月 (Mar)","15","梨花","纯真爱情","忽如一夜春风来，千树万树梨花开。"
"三月 (Mar)","16","紫玉兰 (盛)","高贵典雅","亭亭玉立，气质非凡。"
"三月 (Mar)","17","白玉兰 (盛)","报恩洁净","洁白无瑕，感恩之心。"
"三月 (Mar)","18","樱桃李","幸福喜悦","春光明媚，幸福相伴。"
"三月 (Mar)","19","瑞香 (盛)","吉祥美好","花中祥瑞，好运自来。"
"三月 (Mar)","20","棣棠 (早)","高贵气质","金光闪耀，气质不凡。"
"三月 (Mar)","21","诸葛菜","无私奉献","平凡伟大，默默付出。"
"三月 (Mar)","22","郁李 (盛)","忠诚希望","小巧玲珑，希望满怀。"
"三月 (Mar)","23","贴梗海棠 (盛)","平凡热情","热情似火，平凡之美。"
"三月 (Mar)","24","金钟花 (盛)","期待希望","金色铃铛，摇响希望。"
"三月 (Mar)","25","天堂鸟","幸福快乐","为爱打扮，追求幸福。"
"三月 (Mar)","26","牡丹 (早)","富贵圆满","国色天香，花中之王。"
"三月 (Mar)","27","芍药 (极早)","情有所钟","美丽娇艳，情有独钟。"
"三月 (Mar)","28","含笑 (早)","含蓄矜持","浅笑嫣然，温柔内敛。"
"三月 (Mar)","29","铃兰水仙","纯洁清新","清雅脱俗，如沐春风。"
"三月 (Mar)","30","豆瓣菜花","微小生命","点滴之美，亦是风景。"
"三月 (Mar)","31","荠菜花","奉献一切","平凡之心，甘于奉献。"
"四月 (Apr)","1","樱花 (盛)","爱情希望","樱花红陌上，杨柳绿池边。"
"四月 (Apr)","2","海棠 (盛)","思乡离愁","嫣然一笑，媚态横生。"
"四月 (Apr)","3","牡丹","富贵吉祥","唯有牡丹真国色，花开时节动京城。"
"四月 (Apr)","4","芍药 (早)","美丽动人","自是花中第一流，开向东风烂漫游。"
"四月 (Apr)","5","杜鹃花","爱的喜悦","闲折二枝持在手，细看不似人间有。"
"四月 (Apr)","6","丁香","纯洁初恋","丁香空结雨中愁。"
"四月 (Apr)","7","紫藤","醉人恋情","紫藤挂云木，花蔓宜阳春。"
"四月 (Apr)","8","含笑","含蓄优雅","南方花木变多姿，含笑何由人得知。"
"四月 (Apr)","9","鸢尾","爱的使者","鸢尾蝶一样，翩跹舞春光。"
"四月 (Apr)","10","虞美人","生离死别","春花秋月何时了，往事知多少。"
"四月 (Apr)","11","棣棠","高贵富有","绿满窗前草不除，棣棠花入夏初。"
"四月 (Apr)","12","郁金香 (盛)","永恒祝福","爱意永恒，祝福无限。"
"四月 (Apr)","13","碧桃","消恨之意","人间四月芳菲尽，山寺桃花始盛开。"
"四月 (Apr)","14","晚樱","转瞬即逝","珍惜当下，莫负韶华。"
"四月 (Apr)","15","琼花","美丽高雅","无双亭上最高枝，千点珍珠缀玉肌。"
"四月 (Apr)","16","鲁冰花","母爱奉献","夜夜想起妈妈的话，闪闪的泪光鲁冰花。"
"四月 (Apr)","17","木香","纯洁爱情","幽香清远，情意绵长。"
"四月 (Apr)","18","玫瑰 (早)","爱情真挚","赠人玫瑰，手有余香。"
"四月 (Apr)","19","金盏菊 (春)","盼望之爱","期待重逢，爱意不减。"
"四月 (Apr)","20","欧洲荚蒾","至死不渝","爱情坚贞，生死相随。"
"四月 (Apr)","21","文冠果花","富贵长寿","文思泉涌，福寿绵长。"
"四月 (Apr)","22","七叶树花","幸运祈福","带来幸运，祈愿美好。"
"四月 (Apr)","23","泡桐花","永恒守候","默默守候，情意不变。"
"四月 (Apr)","24","天芥菜","永恒之爱","奉献一切，爱无止境。"
"四月 (Apr)","25","耧斗菜 (盛)","坦率坚持","坚持不懈，坦诚相待。"
"四月 (Apr)","26","黄刺玫","美德希望","耀眼夺目，希望常在。"
"四月 (Apr)","27","金雀花","谦逊优雅","金光闪耀，优雅别致。"
"四月 (Apr)","28","槐花 (早)","美丽脱俗","槐林五月漾琼花，郁郁芬芳醉万家。"
"四月 (Apr)","29","锦带花 (早)","前程似锦","灿烂如锦，前途光明。"
"四月 (Apr)","30","委陵菜","坚韧不拔","生命顽强，不屈不挠。"
"四月 (Apr)","31","流苏树花","生生不息","千年守望，生生不息。"
"五月 (May)","1","芍药 (盛)","依依不舍","春归幽谷始成丛，地面芬敷浅浅红。"
"五月 (May)","2","月季 (玫瑰)","幸福尊敬","花开四季，热情如火。"
"五月 (May)","3","蔷薇","美好爱情","朵朵精神叶叶柔，雨晴香拂醉人头。"
"五月 (May)","4","茉莉花","纯洁质朴","一卉能熏一室香，炎天犹觉玉肌凉。"
"五月 (May)","5","栀子花 (早)","永恒之爱","栀子花开，如此可爱。"
"五月 (May)","6","康乃馨","母爱温馨","伟大母爱，温馨祝福。"
"五月 (May)","7","牡丹 (晚)","圆满浓情","落尽残红始吐芳，佳名唤作百花王。"
"五月 (May)","8","鸢尾 (盛)","热情开朗","生活美好，充满激情。"
"五月 (May)","9","睡莲 (早)","纯洁高雅","出淤泥而不染，濯清涟而不妖。"
"五月 (May)","10","荷花 (早)","清白高尚","接天莲叶无穷碧，映日荷花别样红。"
"五月 (May)","11","铃兰","幸福归来","幸福降临，温馨喜悦。"
"五月 (May)","12","凌霄花 (早)","慈母之爱","努力向上，不负期望。"
"五月 (May)","13","石榴花","成熟美丽","浓绿万枝红一点，动人春色不须多。"
"五月 (May)","14","金银花","真爱奉献","忍冬之花，奉献真情。"
"五月 (May)","15","飞燕草","清静正义","轻盈飘逸，追求正义。"
"五月 (May)","16","锦带花 (盛)","绚烂未来","前程似锦，未来可期。"
"五月 (May)","17","欧洲木绣球","纯洁希望","团团锦簇，希望满怀。"
"五月 (May)","18","槐花","思念故乡","槐林五月漾琼花，郁郁芬芳醉万家。"
"五月 (May)","19","火焰木 (南)","热情无忧","热情似火，无忧无虑。"
"五月 (May)","20","鸡蛋花 (南)","孕育希望","清新淡雅，希望新生。"
"五月 (May)","21","白兰花 (早)","纯洁真挚","暗香浮动，情真意切。"
"五月 (May)","22","六道木","坚韧智慧","历经磨难，智慧生长。"
"五月 (May)","23","溲疏","纯洁谦逊","洁白无瑕，谦逊有礼。"
"五月 (May)","24","毛地黄","虚伪谎言","美丽背后，警惕虚假。"
"五月 (May)","25","耧斗菜 (晚)","感恩怀念","心怀感恩，思念故人。"
"五月 (May)","26","芍药 (盛)","情有所钟","美丽动人，情意绵绵。"
"五月 (May)","27","玫瑰 (盛)","热恋激情","浓情蜜意，爱如烈火。"
"五月 (May)","28","月见草","默默的爱","不求回报，默默付出。"
"五月 (May)","29","福禄考","欢迎和谐","欢迎到来，和睦相处。"
"五月 (May)","30","三色堇 (春)","沉思快乐","快乐源泉，沉思人生。"
"五月 (May)","31","金鱼草 (春)","繁荣昌盛","金玉满堂，生机勃勃。"
"六月 (Jun)","1","荷花 (盛)","清廉君子","出淤泥而不染，濯清涟而不妖。"
"六月 (Jun)","2","睡莲 (盛)","洁净之心","静卧水面，心净如莲。"
"六月 (Jun)","3","茉莉花 (盛)","忠贞尊敬","一卉能熏一室香，炎天犹觉玉肌凉。"
"六月 (Jun)","4","栀子花 (盛)","喜悦坚强","生生不息，喜悦常在。"
"六月 (Jun)","5","月季 (盛)","热情希望","月月花开，希望不绝。"
"六月 (Jun)","6","萱草","忘却忧愁","愿君多采撷，此物最忘忧。"
"六月 (Jun)","7","合欢花","夫妻恩爱","合欢蠲忿，萱草忘忧。"
"六月 (Jun)","8","蜀葵","梦想平安","一丈之内，梦想花开。"
"六月 (Jun)","9","薰衣草","等待爱情","浪漫芬芳，静候佳音。"
"六月 (Jun)","10","玉簪花","恬静宽和","冰清玉洁，恬淡雅致。"
"六月 (Jun)","11","凌霄花 (盛)","敬佩声誉","攀援向上，志存高远。"
"六月 (Jun)","12","石竹","纯洁才能","平凡坚韧，才华横溢。"
"六月 (Jun)","13","美人蕉","美好未来","坚持到底，走向辉煌。"
"六月 (Jun)","14","凤仙花","别碰触我","活泼跳动，保持距离。"
"六月 (Jun)","15","紫薇 (早)","沉迷的爱","盛夏绿遮眼，此花红满堂。"
"六月 (Jun)","16","白兰花 (盛)","高雅纯情","洁白芬芳，情意纯真。"
"六月 (Jun)","17","鸡蛋花 (盛)","平凡简单","简单生活，平凡之美。"
"六月 (Jun)","18","广玉兰","生生不息","高大挺拔，生命力强。"
"六月 (Jun)","19","半枝莲","坚韧希望","顽强生长，希望不灭。"
"六月 (Jun)","20","福禄考 (盛)","团结一致","同心协力，共创美好。"
"六月 (Jun)","21","桔梗 (早)","永恒的爱","真诚不变，爱意永恒。"
"六月 (Jun)","22","鼠尾草","家庭美德","温馨家庭，美德传承。"
"六月 (Jun)","23","丝兰","光辉灿烂","盛开如炬，光芒四射。"
"六月 (Jun)","24","大花葱","聪明可爱","球形花序，聪颖别致。"
"六月 (Jun)","25","唐菖蒲 (早)","坚固怀念","节节高升，思念故人。"
"六月 (Jun)","26","醉蝶花","神秘奥妙","轻盈飘逸，神秘莫测。"
"六月 (Jun)","27","锦葵","温柔说服","温柔抚慰，化解矛盾。"
"六月 (Jun)","28","洋桔梗","不变的爱","富于感情，爱意不变。"
"六月 (Jun)","29","荷兰菊 (早)","活泼愉快","色彩鲜艳，心情愉悦。"
"六月 (Jun)","30","日光菊","热情爽朗","向阳而开，活力四射。"
"六月 (Jun)","31","百子莲","爱情降临","浪漫情怀，爱神降临。"
"七月 (Jul)","1","紫薇 (盛)","好运沉醉","谁道花无百日红，紫薇长放半年花。"
"七月 (Jul)","2","荷花 (盛)","高尚品德","予独爱莲之出淤泥而不染。"
"七月 (Jul)","3","睡莲 (盛)","妖艳纯洁","静美如睡，圣洁脱俗。"
"七月 (Jul)","4","太阳花","光明热情","欣欣向荣，热情似火。"
"七月 (Jul)","5","凤眼莲","此情不渝","漂泊不定，情意不变。"
"七月 (Jul)","6","鸡冠花","真爱永恒","色彩浓烈，爱意不褪。"
"七月 (Jul)","7","向日葵","沉默的爱","向阳而生，追逐光明。"
"七月 (Jul)","8","晚香玉","危险快乐","夜来幽香，暗藏危机。"
"七月 (Jul)","9","大丽花 (早)","感激新颖","雍容华贵，感谢有你。"
"七月 (Jul)","10","美人蕉 (盛)","联想未来","坚实脚步，走向未来。"
"七月 (Jul)","11","昙花","刹那永恒","昙花一现，瞬间即永恒。"
"七月 (Jul)","12","牵牛花","爱情永固","情牵意绊，爱意缠绵。"
"七月 (Jul)","13","夹竹桃","深刻友情","友情长存，警惕危险。"
"七月 (Jul)","14","米兰","有爱光荣","含蓄芬芳，爱是光荣。"
"七月 (Jul)","15","桔梗","无悔之爱","永不改变，无怨无悔。"
"七月 (Jul)","16","唐菖蒲 (盛)","用心坚强","用心经营，坚韧不拔。"
"七月 (Jul)","17","蜀葵 (盛)","温和梦想","温柔守护，梦想花开。"
"七月 (Jul)","18","醉蝶花 (盛)","一起飞翔","如蝶共舞，自由飞翔。"
"七月 (Jul)","19","洋桔梗 (盛)","警戒小心","美丽动人，小心呵护。"
"七月 (Jul)","20","荷兰菊 (盛)","多变的心","色彩缤纷，心情多变。"
"七月 (Jul)","21","百日草","思念远友","友谊长存，思念不变。"
"七月 (Jul)","22","紫茉莉","胆小成熟","夜晚开放，成熟内敛。"
"七月 (Jul)","23","玉簪 (部分)","脱俗雅致","碧叶莹润，花香袭人。"
"七月 (Jul)","24","千屈菜","孤独悲伤","湖畔倩影，略带忧伤。"
"七月 (Jul)","25","美国薄荷","德行高尚","清凉提神，品德高洁。"
"七月 (Jul)","26","姜花","信赖高雅","纯朴高雅，值得信赖。"
"七月 (Jul)","27","水鬼蕉","天生丽质","形态奇特，自然之美。"
"七月 (Jul)","28","文殊兰","夫妇相爱","洁白芳香，情投意合。"
"七月 (Jul)","29","射干","反抗使者","坚韧不屈，勇于反抗。"
"七月 (Jul)","30","假龙头","坚韧不拔","生命顽强，积极向上。"
"七月 (Jul)","31","长春花","愉快回忆","日日春开，回忆美好。"
"八月 (Aug)","1","桂花 (早)","崇高美好","暗淡轻黄体性柔，情疏迹远只香留。"
"八月 (Aug)","2","紫薇 (盛)","好运连连","盛夏绿遮眼，此花红满堂。"
"八月 (Aug)","3","木槿","温柔坚持","坚韧不拔，温柔守候。"
"八月 (Aug)","4","蜀葵 (晚)","热烈梦想","梦想不息，热情似火。"
"八月 (Aug)","5","大丽花 (盛)","大吉大利","绚丽多彩，吉祥如意。"
"八月 (Aug)","6","玉簪花 (盛)","纯洁安静","洁白无瑕，宁静致远。"
"八月 (Aug)","7","雁来红","虚荣假爱","色彩艳丽，警惕虚华。"
"八月 (Aug)","8","石蒜 (早)","优美纯洁","花叶不相见，思念永存。"
"八月 (Aug)","9","凤仙花 (盛)","怀念过去","指尖留香，回忆往昔。"
"八月 (Aug)","10","鸡冠花 (盛)","永生不灭","色彩不褪，真爱永存。"
"八月 (Aug)","11","凌霄花 (晚)","威严慈爱","慈母之爱，深沉威严。"
"八月 (Aug)","12","牵牛花 (盛)","平静爱情","平凡之爱，安稳平静。"
"八月 (Aug)","13","夜来香","纯洁心灵","暗夜芬芳，心灵纯净。"
"八月 (Aug)","14","千日红","不朽爱情","色彩恒久，爱意不渝。"
"八月 (Aug)","15","翠菊","可靠爱情","相信爱情，值得信赖。"
"八月 (Aug)","16","地肤 (花)","清扫烦恼","扫除忧愁，迎接美好。"
"八月 (Aug)","17","姜花 (盛)","将记忆放心底","美好回忆，珍藏心间。"
"八月 (Aug)","18","葱兰","纯洁的爱","洁白无瑕，爱意纯真。"
"八月 (Aug)","19","韭兰","坚强勇敢","风雨无阻，勇敢面对。"
"八月 (Aug)","20","硫华菊","野性之美","奔放自由，野性浪漫。"
"八月 (Aug)","21","波斯菊 (早)","纯真爽朗","少女情怀，永远快乐。"
"八月 (Aug)","22","百日草 (盛)","恒久思念","天长地久，思念不断。"
"八月 (Aug)","23","紫茉莉 (盛)","猜忌成熟","夜晚绽放，成熟之美。"
"八月 (Aug)","24","石竹 (夏秋)","女性之美","纯洁可爱，才华卓越。"
"八月 (Aug)","25","长春花 (盛)","坚贞友情","友情常在，岁月不改。"
"八月 (Aug)","26","珊瑚藤","爱的锁链","心心相印，情意相连。"
"八月 (Aug)","27","蓝雪花","冷淡忧郁","清新淡雅，略带忧愁。"
"八月 (Aug)","28","再力花","清新可人","优雅挺拔，清新怡人。"
"八月 (Aug)","29","紫菀 (早)","回忆反省","回忆往事，反思己过。"
"八月 (Aug)","30","决明花","光明希望","明目清心，带来希望。"
"八月 (Aug)","31","龙胆花 (早)","爱你忧郁","喜欢忧郁，为你心伤。"
"九月 (Sep)","1","桂花 (盛)","吸入你的香","人闲桂花落，夜静春山空。"
"九月 (Sep)","2","菊花 (早)","清净高洁","采菊东篱下，悠然见南山。"
"九月 (Sep)","3","一串红","喜气洋洋","红红火火，家族热爱。"
"九月 (Sep)","4","木芙蓉","平凡中的高洁","晓妆如玉暮如霞，浓淡分秋染此花。"
"九月 (Sep)","5","大丽花 (盛)","雍容华贵","色彩斑斓，富丽堂皇。"
"九月 (Sep)","6","石蒜 (盛)","相互思念","彼岸花开，思念无尽。"
"九月 (Sep)","7","美人蕉 (晚)","美好结果","努力不懈，终得善果。"
"九月 (Sep)","8","雁来红 (盛)","热情虚荣","色彩鲜明，警惕浮华。"
"九月 (Sep)","9","茶花 (早)","谦逊美德","含蓄优雅，美德可嘉。"
"九月 (Sep)","10","迷迭香","留住回忆","芬芳记忆，永不褪色。"
"九月 (Sep)","11","万寿菊","友情健康","友谊长存，健康长寿。"
"九月 (Sep)","12","孔雀草","爽朗活泼","阳光开朗，永远快乐。"
"九月 (Sep)","13","藿香蓟","信赖依靠","值得信赖，可以依靠。"
"九月 (Sep)","14","彼岸花","悲伤回忆","死亡之美，绝望爱情。"
"九月 (Sep)","15","秋海棠","亲切苦恋","相思苦恋，温柔问候。"
"九月 (Sep)","16","波斯菊 (盛)","少女真心","永远快乐，真心不变。"
"九月 (Sep)","17","硫华菊 (盛)","野性奔放","热情如火，自由不羁。"
"九月 (Sep)","18","葱兰 (盛)","期待希望","雨后初开，希望重燃。"
"九月 (Sep)","19","韭兰 (盛)","初恋纯爱","纯洁的爱，如初恋般。"
"九月 (Sep)","20","醉鱼草","为你牺牲","无私奉献，甘愿牺牲。"
"九月 (Sep)","21","蓝雪花 (盛)","忧郁的心","清新淡雅，内心忧郁。"
"九月 (Sep)","22","珊瑚藤 (盛)","爱的牵绊","藤蔓相连，爱意绵绵。"
"九月 (Sep)","23","龙胆花 (盛)","悲伤的你","为你心痛，为你忧伤。"
"九月 (Sep)","24","紫菀 (盛)","爱的占卜","回忆往昔，占卜爱情。"
"九月 (Sep)","25","地榆花","感谢爱慕","含蓄爱慕，心怀感激。"
"九月 (Sep)","26","龙吐珠","珍贵纯洁","纯洁的心，难能可贵。"
"九月 (Sep)","27","木槿 (晚)","坚韧永恒","生命力强，美丽永恒。"
"九月 (Sep)","28","决明 (盛)","希望光明","驱散黑暗，迎接光明。"
"九月 (Sep)","29","狼尾草 (花序)","坚韧暗恋","默默守护，坚韧不拔。"
"九月 (Sep)","30","千屈菜 (晚)","孤独之美","孤芳自赏，独自美丽。"
"九月 (Sep)","31","益母草花","母爱伟大","慈母之心，关怀备至。"
"十月 (Oct)","1","菊花 (盛)","高尚君子","不是花中偏爱菊，此花开尽更无花。"
"十月 (Oct)","2","桂花 (晚)","吉祥如意","桂子月中落，天香云外飘。"
"十月 (Oct)","3","木芙蓉 (盛)","贞操纯洁","拒霜之花，品性高洁。"
"十月 (Oct)","4","茶梅","清雅谦让","姿态优雅，谦逊有礼。"
"十月 (Oct)","5","月季 (秋花)","尊敬幸福","花开不败，幸福常在。"
"十月 (Oct)","6","牵牛花 (晚)","虚幻之爱","爱意缠绵，如梦似幻。"
"十月 (Oct)","7","一串红 (盛)","恋爱的心","热情似火，爱意浓浓。"
"十月 (Oct)","8","万寿菊 (盛)","甜蜜爱情","爱情甜蜜，长长久久。"
"十月 (Oct)","9","孔雀草 (盛)","温柔的爱","阳光明媚，温柔相待。"
"十月 (Oct)","10","芦花","思念故土","蒹葭苍苍，白露为霜。"
"十月 (Oct)","11","芙蓉葵","早熟美貌","美丽早熟，魅力无限。"
"十月 (Oct)","12","彩叶草","绝望恋情","色彩斑斓，爱已无望。"
"十月 (Oct)","13","蜡菊","永恒记忆","永不凋谢，记忆长存。"
"十月 (Oct)","14","野菊","沉默的爱","坚韧不拔，默默守护。"
"十月 (Oct)","15","鼠尾草 (秋)","智慧热情","充满智慧，热情洋溢。"
"十月 (Oct)","16","银杏 (叶色)","坚韧沉着","千年守望，岁月静好。"
"十月 (Oct)","17","枫香 (叶色)","深情思念","层林尽染，思念绵长。"
"十月 (Oct)","18","乌桕 (叶色)","历久弥新","霜叶红于二月花。"
"十月 (Oct)","19","鸡爪槭 (叶色)","热情奔放","色彩热烈，生命绽放。"
"十月 (Oct)","20","地肤 (叶色)","燃烧的爱","秋色如火，爱意燃烧。"
"十月 (Oct)","21","矮牵牛 (秋)","安心同在","与你同在，便是心安。"
"十月 (Oct)","22","苘麻花","温馨祝福","平凡质朴，温馨相伴。"
"十月 (Oct)","23","紫苏花","平凡力量","默默奉献，力量不凡。"
"十月 (Oct)","24","滨菊 (秋)","真实坦诚","真诚的心，坦诚相待。"
"十月 (Oct)","25","蛇鞭菊 (秋)","努力警惕","积极向上，保持警觉。"
"十月 (Oct)","26","粉黛乱子草","等待的爱","如烟似雾，浪漫等待。"
"十月 (Oct)","27","狗尾草 (秋)","暗恋坚韧","平凡坚韧，默默喜欢。"
"十月 (Oct)","28","晚稻花","丰收喜悦","硕果累累，喜悦满怀。"
"十月 (Oct)","29","荞麦花 (秋)","恋人情意","纯洁恋情，情意绵绵。"
"十月 (Oct)","30","棉花","珍惜眼前","温暖纯洁，珍惜拥有。"
"十月 (Oct)","31","香根鸢尾(秋)","优雅之心","高贵优雅，内心丰富。"
"十一月 (Nov)","1","茶花 (盛)","可爱谦让","花姿丰盈，端庄高雅。"
"十一月 (Nov)","2","菊花 (晚)","隐逸长寿","宁可枝头抱香死，何曾吹落北风中。"
"十一月 (Nov)","3","茶梅 (盛)","理性之美","清雅脱俗，理性沉静。"
"十一月 (Nov)","4","山茶 (部分)","谨慎小心","含蓄内敛，小心翼翼。"
"十一月 (Nov)","5","一品红 (早)","我的心在燃烧","热情似火，爱意浓烈。"
"十一月 (Nov)","6","仙客来 (早)","内向好客","羞涩好客，喜迎宾朋。"
"十一月 (Nov)","7","藏红花 (秋)","快乐喜悦","色彩鲜艳，带来快乐。"
"十一月 (Nov)","8","蟹爪兰 (早)","锦上添花","好运相伴，喜事连连。"
"十一月 (Nov)","9","长寿花 (早)","健康长久","福寿安康，生命长青。"
"十一月 (Nov)","10","瓜叶菊 (早)","喜悦快活","色彩明快，心情愉悦。"
"十一月 (Nov)","11","雏菊 (秋播)","隐藏的爱","默默守护，爱在心底。"
"十一月 (Nov)","12","金盏花 (秋播)","离别之痛","惜别不舍，期待重逢。"
"十一月 (Nov)","13","三色堇","白日梦想","沉思冥想，思念对方。"
"十一月 (Nov)","14","芦荟花","自尊洁身","坚韧不拔，洁身自好。"
"十一月 (Nov)","15","虎刺梅","顽强倔强","逆境生长，不屈不挠。"
"十一月 (Nov)","16","枫树 (红叶)","热烈思念","秋叶似火，思念如潮。"
"十一月 (Nov)","17","银杏 (黄叶)","永恒的爱","千年守候，爱意永恒。"
"十一月 (Nov)","18","残菊","高洁晚节","晚节弥坚，品格高尚。"
"十一月 (Nov)","19","紫珠 (果)","聪明伶俐","晶莹剔透，智慧闪耀。"
"十一月 (Nov)","20","火棘 (果)","吉祥喜庆","红果满枝，喜气洋洋。"
"十一月 (Nov)","21","南天竹 (果)","长寿吉祥","寓意吉祥，福寿绵长。"
"十一月 (Nov)","22","枸骨 (花/果)","先见之明","洞察敏锐，远见卓识。"
"十一月 (Nov)","23","蜡梅 (极早)","坚毅高洁","踏雪寻梅，傲骨迎寒。"
"十一月 (Nov)","24","枇杷花","温和默默","含蓄芬芳，默默奉献。"
"十一月 (Nov)","25","山菊","顽强生命","山野绽放，生命不息。"
"十一月 (Nov)","26","甘菊","苦尽甘来","历经磨砺，终得甘甜。"
"十一月 (Nov)","27","冬樱花 (南)","生命希望","寒冬绽放，希望不灭。"
"十一月 (Nov)","28","金花茶","珍贵优雅","花中珍品，高贵典雅。"
"十一月 (Nov)","29","多花紫薇(果)","好运延续","硕果累累，好运常在。"\n"十一月 (Nov)","30","大吴风草","不畏艰难","逆境求生，坚韧不拔。"
"十一月 (Nov)","31","无患子(叶色)","平安无忧","祈愿平安，生活无忧。"
"十二月 (Dec)","1","腊梅 (早)","高风亮节","不与百花争艳，独领寒冬风骚。"
"十二月 (Dec)","2","水仙 (早)","自我陶醉","只缘清香成清趣，全因雅洁博雅名。"
"十二月 (Dec)","3","茶花 (盛)","奋斗胜利","积蓄力量，终将绽放。"
"十二月 (Dec)","4","一品红 (盛)","普天同庆","节日喜庆，祝福满满。"
"十二月 (Dec)","5","仙客来 (盛)","天真无邪","纯洁美好，喜迎佳客。"
"十二月 (Dec)","6","蟹爪兰 (盛)","好运相继","节节开花，好运连连。"
"十二月 (Dec)","7","长寿花 (盛)","吉祥如意","福寿安康，万事胜意。"
"十二月 (Dec)","8","君子兰 (冬)","富贵美满","温文尔雅，富贵吉祥。"
"十二月 (Dec)","9","风信子 (水培)","感谢有你","感谢陪伴，情意浓浓。"
"十二月 (Dec)","10","蝴蝶兰 (促)","仕途顺畅","幸福美满，事业有成。"
"十二月 (Dec)","11","大花蕙兰 (促)","高贵雍容","气质非凡，雍容华贵。"
"十二月 (Dec)","12","朱顶红 (促)","追求真爱","渴望爱情，热情奔放。"
"十二月 (Dec)","13","圣诞玫瑰","矛盾犹豫","美丽有刺，爱恨交织。"
"十二月 (Dec)","14","报春花 (早)","青春的快乐","朝气蓬勃，快乐无忧。"
"十二月 (Dec)","15","银柳 (芽)","生命光辉","银装素裹，生机盎然。"
"十二月 (Dec)","16","梅花 (极早)","不屈不挠","凌寒独放，傲骨铮铮。"
"十二月 (Dec)","17","茶梅 (盛)","谦让之德","清雅高洁，谦逊有礼。"
"十二月 (Dec)","18","枇杷花 (盛)","润物无声","默默奉献，温和慈爱。"
"十二月 (Dec)","19","枸骨 (果)","生命喜悦","红果点点，喜悦生机。"
"十二月 (Dec)","20","火棘 (红果)","热情奔放","如火热情，生命活力。"
"十二月 (Dec)","21","南天竹 (红果)","吉祥长寿","寓意美好，福寿安康。"
"十二月 (Dec)","22","冬青 (红果)","生命永恒","常绿不凋，生命不息。"
"十二月 (Dec)","23","蜡瓣花","纯洁坚韧","冰清玉洁，坚韧不拔。"
"十二月 (Dec)","24","结香 (蕾)","梦想成真","喜结良缘，美梦实现。"
"十二月 (Dec)","25","迎春花 (蕾)","希望在即","含苞待放，希望将至。"
"十二月 (Dec)","26","瑞香 (蕾)","祥瑞预兆","吉祥之兆，好运降临。"
"十二月 (Dec)","27","雪莲 (高山)","纯洁坚毅","冰山雪莲，圣洁高雅。"
"十二月 (Dec)","28","紫金牛 (果)","富贵吉祥","圆润可爱，招财进宝。"
"十二月 (Dec)","29","铁筷子(早花)","坚强勇敢","不畏严寒，勇敢绽放。"
"十二月 (Dec)","30","金边瑞香(蕾)","吉祥好运","金玉满堂，祥瑞之气。"
"十二月 (Dec)","31","常春藤(花果)","忠诚友谊","永不分离，友谊长存。"
`;

    const promptTemplate = `请生成一张为 [公历日期] 设计的日签图片，包含背景图和特定排版的文字。
整体风格：[您想要的风格，例如：中国水墨风格、清新插画风格、可爱卡通风格、温馨水彩风格等]。
背景图案：以“[当日花名]”为主题，例如几朵盛开的 [当日花名]，带些其他点缀。构图需考虑文字区域，在图片上部、中部、底部留有适当空间。

画面比例：默认9：16长屏

文字内容与大致排版（请AI尽力清晰、准确地在图片上渲染以下汉字内容）：

1.  图片左上角或顶部显著位置:
    文字内容：“[当日花名]”

2.  图片右上角区域:
    第一行文字：“[公历日期]”
    第二行文字：一条细长的横线作为分隔
    第三行文字：“[星期几]”
    第四行文字：“[农历日期，例如：乙巳年五月十七]”

3.  图片中部区域 (可与背景有一定融合，但文字需清晰可辨):
    第一行文字（作为花语或主题）：“[花语]”
    第二行文字（作为金句，可分行显示）：“[金句内容]”

4.  图片底部区域:
    文字内容：“宜: [当日宜事，例如：亲近自然, 放松心情]”

补充要求：文字颜色与背景协调，排版美观，字体具有设计感但易于阅读，整体画面高清，色彩和谐。`;

    // --- DOM ELEMENTS ---
    const datePicker = document.getElementById('date-picker');
    const weekdayDisplay = document.getElementById('weekday-display');
    const lunarDisplay = document.getElementById('lunar-display');
    const styleSelect = document.getElementById('style-select');
    const flowerSelect = document.getElementById('flower-select');
    const flowerLangDisplay = document.getElementById('flower-lang-display');
    const goldenSentenceDisplay = document.getElementById('golden-sentence-display');
    const eventInput = document.getElementById('event-input');
    const generateBtn = document.getElementById('generate-btn');
    const copyBtn = document.getElementById('copy-btn');
    const promptOutput = document.getElementById('prompt-output');

    // --- LUNAR CALENDAR (Simplified) ---
    // A simple lunar calendar converter. For full accuracy, a larger library is needed.
    // This is a placeholder implementation.
    const lunarCalendar = {
        tg: '甲乙丙丁戊己庚辛壬癸',
        dz: '子丑寅卯辰巳午未申酉戌亥',
        mz: '正二三四五六七八九十冬腊',
        sx: '鼠牛虎兔龙蛇马羊猴鸡狗猪',
        solarTerm: ["小寒", "大寒", "立春", "雨水", "惊蛰", "春分", "清明", "谷雨", "立夏", "小满", "芒种", "夏至", "小暑", "大暑", "立秋", "处暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至"],
        sTermInfo: [0, 21208, 42467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693, 263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758],
        nStr1: ['日', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十'],
        nStr2: ['初', '十', '廿', '卅', ' '],
        lunarInfo: [
            0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,
            0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,
            0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,
            0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,
            0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,
            0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5d0, 0x14573, 0x052d0, 0x0a9a8, 0x0e950, 0x06aa0,
            0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,
            0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b5a0, 0x195a6,
            0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,
            0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,
            0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,
            0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,
            0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,
            0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,
            0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0
        ],
        lYearDays: (y) => {
            let i, sum = 348;
            for (i = 0x8000; i > 0x8; i >>= 1) sum += (lunarCalendar.lunarInfo[y - 1900] & i) ? 1 : 0;
            return (sum + lunarCalendar.leapDays(y));
        },
        leapDays: (y) => {
            if (lunarCalendar.leapMonth(y)) return ((lunarCalendar.lunarInfo[y - 1900] & 0x10000) ? 30 : 29);
            else return (0);
        },
        leapMonth: (y) => {
            return (lunarCalendar.lunarInfo[y - 1900] & 0xf);
        },
        monthDays: (y, m) => {
            return ((lunarCalendar.lunarInfo[y - 1900] & (0x10000 >> m)) ? 30 : 29);
        },
        toLunar: (objDate) => {
            let i, leap = 0, temp = 0;
            let baseDate = new Date(1900, 0, 31);
            let offset = (objDate - baseDate) / 86400000;
            let dayCyl = offset + 40;
            let monCyl = 14;
            for (i = 1900; i < 2050 && offset > 0; i++) {
                temp = lunarCalendar.lYearDays(i);
                offset -= temp;
                monCyl += 12;
            }
            if (offset < 0) {
                offset += temp;
                i--;
                monCyl -= 12;
            }
            let year = i;
            let yearCyl = i - 1864;
            leap = lunarCalendar.leapMonth(i);
            let isLeap = false;
            for (i = 1; i < 13 && offset > 0; i++) {
                if (leap > 0 && i == (leap + 1) && isLeap == false) {
                    --i; isLeap = true; temp = lunarCalendar.leapDays(year);
                } else {
                    temp = lunarCalendar.monthDays(year, i);
                }
                if (isLeap == true && i == (leap + 1)) isLeap = false;
                offset -= temp;
                if (isLeap == false) monCyl++;
            }
            if (offset == 0 && leap > 0 && i == leap + 1)
                if (isLeap) { isLeap = false; }
                else { isLeap = true; --i; --monCyl; }
            if (offset < 0) { offset += temp; --i; --monCyl; }
            let month = i;
            let day = Math.round(offset) + 1;
            let cDay = (d) => {
                let s;
                switch (d) {
                    case 10: s = '初十'; break;
                    case 20: s = '二十'; break;
                    case 30: s = '三十'; break;
                    default:
                        s = lunarCalendar.nStr2[Math.floor(d / 10)];
                        s += lunarCalendar.nStr1[d % 10];
                }
                return (s);
            };
            return {
                year: lunarCalendar.tg[yearCyl % 10] + lunarCalendar.dz[yearCyl % 12] + '年',
                month: (isLeap ? '闰' : '') + lunarCalendar.mz[month - 1] + '月',
                day: cDay(day)
            };
        }
    };

    // --- DATA PROCESSING ---
    let flowerData = [];

    function parseCSV(data) {
        // Remove BOM and split into lines
        const lines = data.replace(/^\uFEFF/, '').trim().split('\n');
        const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
        
        return lines.slice(1).map(line => {
            const values = line.split(',').map(v => v.trim().replace(/"/g, ''));
            let entry = {};
            headers.forEach((header, i) => {
                entry[header] = values[i];
            });
            return entry;
        });
    }

    // --- UI UPDATE FUNCTIONS ---

    function updateDateInfo(dateString) {
        const date = new Date(dateString);
        // Adjust for timezone offset to prevent day-off errors
        const adjustedDate = new Date(date.valueOf() + date.getTimezoneOffset() * 60 * 1000);

        // Update weekday
        const weekdays = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
        weekdayDisplay.textContent = weekdays[adjustedDate.getDay()];

        // Update lunar date
        const lunarDate = lunarCalendar.toLunar(adjustedDate);
        lunarDisplay.textContent = `${lunarDate.year}${lunarDate.month}${lunarDate.day}`;
    }

    function updateFlowerDropdown(month, day) { // month is 1-based, day is 1-based
        const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        const currentMonthStr = monthNames[month - 1];

        const flowersForMonth = flowerData.filter(item => item['月份'].includes(`(${currentMonthStr})`));
        
        flowerSelect.innerHTML = '';
        if (flowersForMonth.length === 0) {
            flowerSelect.innerHTML = '<option>当月无花语数据</option>';
            return;
        }

        flowersForMonth.forEach(flower => {
            const option = document.createElement('option');
            // Clean flower name: remove content in parentheses
            option.textContent = flower['花名'].replace(/\s*\(.*\)\s*/, '').trim();
            option.value = flower['花名']; // Use original name as value to find it back
            flowerSelect.appendChild(option);
        });

        // Try to select the flower matching the day's serial number
        const flowerForDay = flowersForMonth.find(f => parseInt(f['序号'], 10) === day);
        if (flowerForDay) {
            flowerSelect.value = flowerForDay['花名'];
        }
        
        // Trigger change to update info for the selected flower
        flowerSelect.dispatchEvent(new Event('change'));
    }

    function generateSuitableActivity(language) {
        if (!language) return "亲近自然, 放松心情";

        const activityMap = {
            '吉祥': ['祈愿美好, 迎接好运', '分享福气, 传递喜悦', '图个吉利, 万事顺心'],
            '好运': ['祈愿美好, 迎接好运', '分享福气, 传递喜悦', '把握机遇, 期待惊喜'],
            '富贵': ['祈愿美好, 迎接好运', '规划理财, 创造价值', '享受生活, 感恩富足'],
            '纯洁': ['静心思考, 保持纯真', '回归初心, 感受宁静', '整理心情, 净化心灵'],
            '高洁': ['静心思考, 保持纯真', '提升品格, 严于律己', '阅读好书, 陶冶情操'],
            '纯真': ['静心思考, 保持纯真', '回归初心, 感受宁静', '与友同乐, 分享快乐'],
            '坚强': ['磨练意志, 挑战自我', '勇往直前, 绝不退缩', '坚持锻炼, 强健体魄'],
            '坚韧': ['磨练意志, 挑战自我', '坚持不懈, 必有回响', '直面困难, 迎难而上'],
            '不屈': ['磨练意志, 挑战自我', '勇往直前, 绝不退缩', '坚守信念, 永不言弃'],
            '爱情': ['表达爱意, 珍惜缘分', '与爱人约会, 制造浪漫', '回顾甜蜜, 感恩相伴'],
            '恋情': ['表达爱意, 珍惜缘分', '与爱人约会, 制造浪漫', '写封情书, 传递心意'],
            '希望': ['展望未来, 拥抱希望', '制定计划, 迎接挑战', '与友畅谈, 寻找灵感'],
            '光明': ['展望未来, 拥抱希望', '积极乐观, 传播正能量', '帮助他人, 点亮心灯'],
            '喜悦': ['分享快乐, 感受生活', '记录开心瞬间, 制作相册', '做件趣事, 博君一笑'],
            '快乐': ['分享快乐, 感受生活', '看场喜剧, 放声大笑', '享受美食, 犒劳自己'],
            '思念': ['怀念过往, 感恩相遇', '联系旧友, 互道安好', '整理旧物, 回味时光'],
            '回忆': ['怀念过往, 感恩相遇', '翻看老照片, 重温美好', '写下日记, 记录此刻'],
            '美丽': ['发现美好, 提升品味', '精心打扮, 自信出门', '学习插花, 装饰家居'],
            '优雅': ['发现美好, 提升品味', '练习瑜伽, 舒展身心', '欣赏艺术, 陶冶情操'],
            '幸福': ['珍惜当下, 感受幸福', '为家人做饭, 共享天伦', '完成小目标, 收获成就'],
            '美满': ['珍惜当下, 感受幸福', '陪伴家人, 享受温馨', '感恩所有, 知足常乐'],
            '美好': ['创造美好, 记录点滴', '帮助他人, 收获快乐', '打扫房间, 焕然一新'],
            '未来': ['规划未来, 努力前行', '学习新知, 投资自己', '设定目标, 逐步实现'],
            '君子': ['提升品格, 严于律己', '阅读经典, 明理增慧', '谦虚待人, 诚信处事'],
            '品格': ['提升品格, 严于律己', '反思言行, 择善而从', '乐于助人, 积善成德'],
            '之心': ['倾听内心, 感受宁静', '练习冥想, 放空自己', '独自散步, 与己对话'],
            '心灵': ['倾听内心, 感受宁静', '阅读好书, 滋养精神', '接触自然, 疗愈身心'],
            '尊敬': ['尊敬师长, 心怀感恩', '帮助长辈, 表达孝心', '虚心求教, 学习经验'],
            '忘忧': ['放松心情, 忘却烦恼', '听听音乐, 舒缓压力', '出门走走, 拥抱自然'],
            '放松': ['放松心情, 忘却烦恼', '泡个热水澡, 舒缓身心', '看部好电影, 享受闲暇'],
            '恩爱': ['陪伴家人, 享受温馨', '制造小惊喜, 增进感情', '分担家务, 体贴对方'],
            '家庭': ['陪伴家人, 享受温馨', '组织家庭聚会, 共享欢乐', '关心长辈, 陪伴孩子'],
            '梦想': ['追逐梦想, 永不放弃', '为梦想行动, 迈出一步', '与同好交流, 互相鼓励'],
            '等待': ['保持耐心, 静候佳音', '专注当下, 做好准备', '顺其自然, 平和心态'],
            '恬静': ['享受安静, 品味生活', '泡杯清茶, 静心阅读', '练习书法, 陶冶心性'],
            '安静': ['享受安静, 品味生活', '独自思考, 整理思绪', '远离喧嚣, 寻片净土'],
            '坚持': ['坚持不懈, 必有回响', '完成一项任务, 挑战毅力', '每日运动, 持之以恒'],
        };

        for (const key in activityMap) {
            if (language.includes(key)) {
                const activities = activityMap[key];
                const randomIndex = Math.floor(Math.random() * activities.length);
                return activities[randomIndex];
            }
        }
        return "亲近自然, 放松心情"; // Default fallback
    }

    function updateFlowerInfo() {
        const selectedFlowerName = flowerSelect.value;
        if (!selectedFlowerName) {
            flowerLangDisplay.textContent = '';
            goldenSentenceDisplay.textContent = '';
            eventInput.value = '亲近自然, 放松心情'; // Reset to default
            return;
        }

        const flower = flowerData.find(f => f['花名'] === selectedFlowerName);
        if (flower) {
            const flowerLanguage = flower['花语 (四字)'];
            flowerLangDisplay.textContent = flowerLanguage;
            goldenSentenceDisplay.textContent = flower['金句'];
            // Generate and set the suitable activity
            eventInput.value = generateSuitableActivity(flowerLanguage);
        }
    }

    function generatePrompt() {
        const date = new Date(datePicker.value);
        const adjustedDate = new Date(date.valueOf() + date.getTimezoneOffset() * 60 * 1000);

        const replacements = {
            '[公历日期]': adjustedDate.toLocaleDateString('zh-CN'),
            '[您想要的风格，例如：中国水墨风格、清新插画风格、可爱卡通风格、温馨水彩风格等]': styleSelect.value,
            '[当日花名]': flowerSelect.value.replace(/\s*\(.*\)\s*/, '').trim(),
            '[星期几]': weekdayDisplay.textContent,
            '[农历日期，例如：乙巳年五月十七]': lunarDisplay.textContent,
            '[花语]': flowerLangDisplay.textContent,
            '[金句内容]': goldenSentenceDisplay.textContent,
            '[当日宜事，例如：亲近自然, 放松心情]': eventInput.value
        };

        let finalPrompt = promptTemplate;
        for (const key in replacements) {
            finalPrompt = finalPrompt.replace(new RegExp(key.replace(/\[/g, '\\[').replace(/\]/g, '\\]'), 'g'), replacements[key]);
        }

        promptOutput.value = finalPrompt;
    }

    function copyPrompt() {
        if (!promptOutput.value) {
            alert('请先生成提示词！');
            return;
        }
        navigator.clipboard.writeText(promptOutput.value).then(() => {
            alert('提示词已成功复制到剪贴板！');
        }).catch(err => {
            alert('复制失败，请手动复制。');
            console.error('Copy failed', err);
        });
    }

    // --- INITIALIZATION ---

    function init() {
        // 1. Parse data
        flowerData = parseCSV(csvData);

        // 2. Set up event listeners
        datePicker.addEventListener('change', () => {
            const date = new Date(datePicker.value);
            // Use getUTCDate to avoid timezone issues and match the date picker's value
            const day = date.getUTCDate(); 
            updateDateInfo(datePicker.value);
            updateFlowerDropdown(date.getUTCMonth() + 1, day);
        });
        flowerSelect.addEventListener('change', updateFlowerInfo);
        generateBtn.addEventListener('click', generatePrompt);
        copyBtn.addEventListener('click', copyPrompt);

        // 3. Set initial state
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        
        datePicker.value = `${yyyy}-${mm}-${dd}`;
        
        // Trigger initial updates
        datePicker.dispatchEvent(new Event('change'));
    }

    init();
});
